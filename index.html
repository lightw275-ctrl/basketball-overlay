<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lights Basketball Counter Control Panel</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #0b0b0b;
    font-family: system-ui, sans-serif;
    color: white;
  }
  h1 { text-align: center; margin-top: 16px; }

  .controls {
    max-width: 720px;
    margin: 20px auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }
  .control-box {
    background: #111;
    padding: 16px;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .big-num {
    font-size: 96px;
    font-weight: bold;
    margin-bottom: 12px;
  }
  .btn {
    padding: 10px 14px;
    border-radius: 8px;
    background: #0a84ff;
    color: white;
    cursor: pointer;
    margin: 4px;
    text-align: center;
  }
  .btn.secondary { background: #333; }
  .kbd { font-weight: bold; background: #00000066; padding: 6px 8px; border-radius: 6px; }
  .mode-select { text-align:center; margin-bottom:12px; }
</style>
</head>
<body>
<h1>Lights Basketball Counter Control Panel</h1>
<div class="mode-select">
  <label>Mode: </label>
  <select id="modeSelect">
    <option value="challenge">Challenge (Hits/Misses)</option>
    <option value="normal">Normal (Points)</option>
  </select>
</div>

<div class="controls" id="challengeControls">
  <div class="control-box">
    <div class="big-num" id="hitsBig">0</div>
    <div>Hits</div>
    <div>
      <div class="btn" id="hitBtn">+1 Hit</div>
      <div class="btn secondary" id="hitDec">-1 Hit</div>
    </div>
  </div>
  <div class="control-box">
    <div class="big-num" id="missBig">0</div>
    <div>Misses</div>
    <div>
      <div class="btn" id="missBtn">+1 Miss</div>
      <div class="btn secondary" id="missDec">-1 Miss</div>
    </div>
  </div>
</div>

<div class="controls" id="normalControls" style="display:none;">
  <div class="control-box" style="width:100%;">
    <div class="big-num" id="pointsBig">0</div>
    <div>Points</div>
    <div>
      <div class="btn" id="pointBtn">+1 Point</div>
      <div class="btn secondary" id="pointDec">-1 Point</div>
    </div>
  </div>
</div>

<div style="text-align:center; margin-top:20px;">
  <div class="btn" id="resetBtn">Reset All</div>
</div>

<script>
const bcChannel = ('BroadcastChannel' in window) ? new BroadcastChannel('basket-counter-channel') : null;

let state = { hits:0, misses:0, points:0 };
let mode = 'challenge';

const hitsEl = document.getElementById('hitsBig');
const missesEl = document.getElementById('missBig');
const pointsEl = document.getElementById('pointsBig');

function sendState(){ if(bcChannel) bcChannel.postMessage({type:'state', state}); }
function updateUI(){
  hitsEl.textContent = state.hits;
  missesEl.textContent = state.misses;
  pointsEl.textContent = state.points;
}

// Mode selection
const modeSelect = document.getElementById('modeSelect');
modeSelect.addEventListener('change', ()=>{
  mode = modeSelect.value;
  document.getElementById('challengeControls').style.display = (mode==='challenge')?'grid':'none';
  document.getElementById('normalControls').style.display = (mode==='normal')?'grid':'none';
});

// Buttons
document.getElementById('hitBtn').onclick = ()=>{ state.hits++; updateUI(); sendState(); };
document.getElementById('hitDec').onclick = ()=>{ if(state.hits>0) state.hits--; updateUI(); sendState(); };
document.getElementById('missBtn').onclick = ()=>{ state.misses++; updateUI(); sendState(); };
document.getElementById('missDec').onclick = ()=>{ if(state.misses>0) state.misses--; updateUI(); sendState(); };
document.getElementById('pointBtn').onclick = ()=>{ state.points++; updateUI(); sendState(); };
document.getElementById('pointDec').onclick = ()=>{ if(state.points>0) state.points--; updateUI(); sendState(); };
document.getElementById('resetBtn').onclick = ()=>{ state={hits:0,misses:0,points:0}; updateUI(); sendState(); };

// Keyboard shortcuts
window.addEventListener('keydown', e=>{
  if(mode==='challenge'){
    if(e.key==='h'||e.key==='H'){ state.hits++; updateUI(); sendState(); }
    if(e.key==='m'||e.key==='M'){ state.misses++; updateUI(); sendState(); }
    if(e.key==='r'||e.key==='R'){ state.hits=0; state.misses=0; updateUI(); sendState(); }
  } else {
    if(e.key==='p'||e.key==='P'){ state.points++; updateUI(); sendState(); }
    if(e.key==='r'||e.key==='R'){ state.points=0; updateUI(); sendState(); }
  }
});

// Receive updates
if(bcChannel){
  bcChannel.onmessage = ev=>{
    if(ev.data?.type==='state'){ state = ev.data.state; updateUI(); }
  };
}

updateUI();
</script>
</body>
</html>
